<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>数据库项目实践（一）</title>
      <link href="/2019/12/14/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%EF%BC%88%E4%B8%80%EF%BC%89/"/>
      <url>/2019/12/14/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="项目整体需求分析"><a href="#项目整体需求分析" class="headerlink" title="项目整体需求分析"></a>项目整体需求分析</h2><p>项目： <strong>项目名称</strong>， 计划名称， 项目类型， 项目进度， 项目负责人， 项目创建时间<br>团队： <strong>团队名称</strong>， 团队负责人， 团队人数， 团队创建时间<br>人员： 姓名， 团队负责人， 任务负责人， <strong>工号</strong>， 性别， 年龄， 工龄， 归属单位<br>任务资源： <strong>资源名称</strong>， 资源种类， 资源能力， 归属单位<br>任务： <strong>任务名称</strong>， 任务负责人， 任务预算， 实际花费， 任务总进度， 花费时间<br>订单：<strong>物品名称</strong>， 价格， 种类<br>项目计划： <strong>计划名称</strong>， 预算， 花费时间， 阶段划分<br>风险： <strong>风险名称</strong>， 风险种类， 解决方法<br>项目变更： <strong>变更编号</strong>， 变更前类型， 变更后类型， 变更原因， 变更时间<br>加粗的为主码</p><h2 id="ER图实现"><a href="#ER图实现" class="headerlink" title="ER图实现"></a>ER图实现</h2><h3 id="分表实现"><a href="#分表实现" class="headerlink" title="分表实现"></a>分表实现</h3><p><a href="https://postimg.cc/p9mk4sB2" target="_blank" rel="noopener"><img src="https://i.postimg.cc/0Nf363MJ/RS-H-F-JIFT-G32-O-J.png" alt="各个主键ER图"></a></p><h3 id="总和实现"><a href="#总和实现" class="headerlink" title="总和实现"></a>总和实现</h3><p><a href="https://postimg.cc/sM6wTk76" target="_blank" rel="noopener"><img src="https://i.postimg.cc/s2yqgyXr/522-VO-YM-SLB-YX6-A-MD.png" alt="完整ER图"></a></p><h2 id="CDM图实现"><a href="#CDM图实现" class="headerlink" title="CDM图实现"></a>CDM图实现</h2><p> <a href="https://postimg.cc/yg9jYW5t" target="_blank" rel="noopener"><img src="https://i.postimg.cc/rmZPjr9V/1.jpg" alt="CDM图"></a></p><h2 id="PMD图实现"><a href="#PMD图实现" class="headerlink" title="PMD图实现"></a>PMD图实现</h2><p> <a href="https://postimg.cc/VS248X7X" target="_blank" rel="noopener"><img src="https://i.postimg.cc/26Stnwh9/2.jpg" alt="PDM图"></a></p><h2 id="SQL-SERVER2012-代码生成"><a href="#SQL-SERVER2012-代码生成" class="headerlink" title="SQL SERVER2012 代码生成"></a>SQL SERVER2012 代码生成</h2><pre><code>  /*==============================================================*/  /* DBMS name:      Microsoft SQL Server 2012                    */  /* Created on:     2019/12/14 18:45:09                          */  /*==============================================================*/  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;Change&#39;) and o.name = &#39;FK_CHANGE_ADMINISTE_PROJECT&#39;)  alter table Change    drop constraint FK_CHANGE_ADMINISTE_PROJECT  go  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;Difficult&#39;) and o.name = &#39;FK_DIFFICUL_ADMINISTE_PROJECT&#39;)  alter table Difficult    drop constraint FK_DIFFICUL_ADMINISTE_PROJECT  go  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;&quot;Plan&quot;&#39;) and o.name = &#39;FK_PLAN_ADMINISTE_PROJECT&#39;)  alter table &quot;Plan&quot;    drop constraint FK_PLAN_ADMINISTE_PROJECT  go  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;Project&#39;) and o.name = &#39;FK_PROJECT_ADMINISTE_PLAN&#39;)  alter table Project    drop constraint FK_PROJECT_ADMINISTE_PLAN  go  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;Purchaes&#39;) and o.name = &#39;FK_PURCHAES_PURCHAES_TASK&#39;)  alter table Purchaes    drop constraint FK_PURCHAES_PURCHAES_TASK  go  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;Purchaes&#39;) and o.name = &#39;FK_PURCHAES_PURCHAES2_ORDER&#39;)  alter table Purchaes    drop constraint FK_PURCHAES_PURCHAES2_ORDER  go  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;&quot;Resource Usage&quot;&#39;) and o.name = &#39;FK_RESOURCE_RESOURCE _TASK&#39;)  alter table &quot;Resource Usage&quot;    drop constraint &quot;FK_RESOURCE_RESOURCE _TASK&quot;  go  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;&quot;Resource Usage&quot;&#39;) and o.name = &#39;FK_RESOURCE_RESOURCE _RESOURCE&#39;)  alter table &quot;Resource Usage&quot;    drop constraint &quot;FK_RESOURCE_RESOURCE _RESOURCE&quot;  go  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;Staff&#39;) and o.name = &#39;FK_STAFF_MAKE2_TASK&#39;)  alter table Staff    drop constraint FK_STAFF_MAKE2_TASK  go  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;Staff&#39;) and o.name = &#39;FK_STAFF_RELATIONS_TEAM&#39;)  alter table Staff    drop constraint FK_STAFF_RELATIONS_TEAM  go  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;Staff&#39;) and o.name = &#39;FK_STAFF_TEAM LEAD_STAFF&#39;)  alter table Staff    drop constraint &quot;FK_STAFF_TEAM LEAD_STAFF&quot;  go  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;Task&#39;) and o.name = &#39;FK_TASK_INCLUDE_PROJECT&#39;)  alter table Task    drop constraint FK_TASK_INCLUDE_PROJECT  go  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;Task&#39;) and o.name = &#39;FK_TASK_MAKE_STAFF&#39;)  alter table Task    drop constraint FK_TASK_MAKE_STAFF  go  if exists (select 1    from sys.sysreferences r join sys.sysobjects o on (o.id = r.constid and o.type = &#39;F&#39;)    where r.fkeyid = object_id(&#39;Team&#39;) and o.name = &#39;FK_TEAM_IMPLEMENT_PROJECT&#39;)  alter table Team    drop constraint FK_TEAM_IMPLEMENT_PROJECT  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;Change&#39;)              and   name  = &#39;Administer4_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index Change.Administer4_FK  go  if exists (select 1              from  sysobjects            where  id = object_id(&#39;Change&#39;)              and   type = &#39;U&#39;)    drop table Change  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;Difficult&#39;)              and   name  = &#39;Administer3_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index Difficult.Administer3_FK  go  if exists (select 1              from  sysobjects            where  id = object_id(&#39;Difficult&#39;)              and   type = &#39;U&#39;)    drop table Difficult  go  if exists (select 1              from  sysobjects            where  id = object_id(&#39;&quot;Order&quot;&#39;)              and   type = &#39;U&#39;)    drop table &quot;Order&quot;  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;&quot;Plan&quot;&#39;)              and   name  = &#39;Administer2_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index &quot;Plan&quot;.Administer2_FK  go  if exists (select 1              from  sysobjects            where  id = object_id(&#39;&quot;Plan&quot;&#39;)              and   type = &#39;U&#39;)    drop table &quot;Plan&quot;  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;Project&#39;)              and   name  = &#39;Administer1_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index Project.Administer1_FK  go  if exists (select 1              from  sysobjects            where  id = object_id(&#39;Project&#39;)              and   type = &#39;U&#39;)    drop table Project  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;Purchaes&#39;)              and   name  = &#39;Purchaes2_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index Purchaes.Purchaes2_FK  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;Purchaes&#39;)              and   name  = &#39;Purchaes_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index Purchaes.Purchaes_FK  go  if exists (select 1              from  sysobjects            where  id = object_id(&#39;Purchaes&#39;)              and   type = &#39;U&#39;)    drop table Purchaes  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;&quot;Resource Usage&quot;&#39;)              and   name  = &#39;Resource Usage2_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index &quot;Resource Usage&quot;.&quot;Resource Usage2_FK&quot;  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;&quot;Resource Usage&quot;&#39;)              and   name  = &#39;Resource Usage_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index &quot;Resource Usage&quot;.&quot;Resource Usage_FK&quot;  go  if exists (select 1              from  sysobjects            where  id = object_id(&#39;&quot;Resource Usage&quot;&#39;)              and   type = &#39;U&#39;)    drop table &quot;Resource Usage&quot;  go  if exists (select 1              from  sysobjects            where  id = object_id(&#39;Resources&#39;)              and   type = &#39;U&#39;)    drop table Resources  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;Staff&#39;)              and   name  = &#39;Team Leader_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index Staff.&quot;Team Leader_FK&quot;  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;Staff&#39;)              and   name  = &#39;Make2_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index Staff.Make2_FK  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;Staff&#39;)              and   name  = &#39;Relationship_6_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index Staff.Relationship_6_FK  go  if exists (select 1              from  sysobjects            where  id = object_id(&#39;Staff&#39;)              and   type = &#39;U&#39;)    drop table Staff  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;Task&#39;)              and   name  = &#39;Make_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index Task.Make_FK  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;Task&#39;)              and   name  = &#39;Include_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index Task.Include_FK  go  if exists (select 1              from  sysobjects            where  id = object_id(&#39;Task&#39;)              and   type = &#39;U&#39;)    drop table Task  go  if exists (select 1              from  sysindexes            where  id    = object_id(&#39;Team&#39;)              and   name  = &#39;Implement_FK&#39;              and   indid &gt; 0              and   indid &lt; 255)    drop index Team.Implement_FK  go  if exists (select 1              from  sysobjects            where  id = object_id(&#39;Team&#39;)              and   type = &#39;U&#39;)    drop table Team  go  /*==============================================================*/  /* Table: Change                                                */  /*==============================================================*/  create table Change (    ChangeNo             char(10)             not null,    ProjectName          char(20)             null,    ChangeBeforeType     char(15)             not null,    ChangeAfterType      char(15)             not null,    ChangeReason         char(50)             not null,    ChangeTime           datetime             not null,    constraint PK_CHANGE primary key nonclustered (ChangeNo)  )  go  /*==============================================================*/  /* Index: Administer4_FK                                        */  /*==============================================================*/  create index Administer4_FK on Change (  ProjectName ASC  )  go  /*==============================================================*/  /* Table: Difficult                                             */  /*==============================================================*/  create table Difficult (    DifficultName        char(20)             not null,    ProjectName          char(20)             null,    DifficultType        char(15)             not null,    constraint PK_DIFFICULT primary key nonclustered (DifficultName)  )  go  /*==============================================================*/  /* Index: Administer3_FK                                        */  /*==============================================================*/  create index Administer3_FK on Difficult (  ProjectName ASC  )  go  /*==============================================================*/  /* Table: &quot;Order&quot;                                               */  /*==============================================================*/  create table &quot;Order&quot; (    OrderName            char(10)             not null,    OrderPrice           int                  not null,    OrderType            char(15)             not null,    constraint PK_ORDER primary key nonclustered (OrderName)  )  go  /*==============================================================*/  /* Table: &quot;Plan&quot;                                                */  /*==============================================================*/  create table &quot;Plan&quot; (    PlanName             char(20)             not null,    ProjectName          char(20)             null,    PlanBudget           int                  not null,    PlanTime             datetime             not null,    PlanFeasibility      char(2)              not null,    constraint PK_PLAN primary key nonclustered (PlanName)  )  go  /*==============================================================*/  /* Index: Administer2_FK                                        */  /*==============================================================*/  create index Administer2_FK on &quot;Plan&quot; (  ProjectName ASC  )  go  /*==============================================================*/  /* Table: Project                                               */  /*==============================================================*/  create table Project (    ProjectName          char(20)             not null,    PlanName             char(20)             null,    ProjectType          char(15)             not null,    ProjectProgress      char(10)             not null,    ProjectLeader        char(10)             not null,    ProjectCreateTime    datetime             not null,    constraint PK_PROJECT primary key nonclustered (ProjectName)  )  go  /*==============================================================*/  /* Index: Administer1_FK                                        */  /*==============================================================*/  create index Administer1_FK on Project (  PlanName ASC  )  go  /*==============================================================*/  /* Table: Purchaes                                              */  /*==============================================================*/  create table Purchaes (    TaskName             char(20)             not null,    OrderName            char(10)             not null,    PurchaseNumber       int                  null,    constraint PK_PURCHAES primary key (TaskName, OrderName)  )  go  /*==============================================================*/  /* Index: Purchaes_FK                                           */  /*==============================================================*/  create index Purchaes_FK on Purchaes (  TaskName ASC  )  go  /*==============================================================*/  /* Index: Purchaes2_FK                                          */  /*==============================================================*/  create index Purchaes2_FK on Purchaes (  OrderName ASC  )  go  /*==============================================================*/  /* Table: &quot;Resource Usage&quot;                                      */  /*==============================================================*/  create table &quot;Resource Usage&quot; (    TaskName             char(20)             not null,    ResourcesName        char(20)             not null,    &quot;Use Duration&quot;       char(10)             null,    constraint &quot;PK_RESOURCE USAGE&quot; primary key (TaskName, ResourcesName)  )  go  /*==============================================================*/  /* Index: &quot;Resource Usage_FK&quot;                                   */  /*==============================================================*/  create index &quot;Resource Usage_FK&quot; on &quot;Resource Usage&quot; (  TaskName ASC  )  go  /*==============================================================*/  /* Index: &quot;Resource Usage2_FK&quot;                                  */  /*==============================================================*/  create index &quot;Resource Usage2_FK&quot; on &quot;Resource Usage&quot; (  ResourcesName ASC  )  go  /*==============================================================*/  /* Table: Resources                                             */  /*==============================================================*/  create table Resources (    ResourcesName        char(20)             not null,    ResourcesType        char(15)             not null,    ResourcesAbility     char(20)             not null,    ResourcesAscription  char(10)             not null,    constraint PK_RESOURCES primary key nonclustered (ResourcesName)  )  go  /*==============================================================*/  /* Table: Staff                                                 */  /*==============================================================*/  create table Staff (    StaffName            char(10)             not null,    StaffNo              char(10)             not null,    TaskName             char(20)             null,    TeamName             char(20)             null,    Sta_StaffNo          char(10)             null,    StaffSex             char(2)              not null,    StaffAge             int                  not null,    StaffWorkYear        int                  not null,    StaffAscription      char(10)             not null,    constraint PK_STAFF primary key nonclustered (StaffNo)  )  go  /*==============================================================*/  /* Index: Relationship_6_FK                                     */  /*==============================================================*/  create index Relationship_6_FK on Staff (  TeamName ASC  )  go  /*==============================================================*/  /* Index: Make2_FK                                              */  /*==============================================================*/  create index Make2_FK on Staff (  TaskName ASC  )  go  /*==============================================================*/  /* Index: &quot;Team Leader_FK&quot;                                      */  /*==============================================================*/  create index &quot;Team Leader_FK&quot; on Staff (  Sta_StaffNo ASC  )  go  /*==============================================================*/  /* Table: Task                                                  */  /*==============================================================*/  create table Task (    TaskName             char(20)             not null,    StaffNo              char(10)             null,    ProjectName          char(20)             null,    TaskLeader           char(10)             not null,    TaskBudget           int                  not null,    TaskCost             int                  not null,    TaskState            char(10)             not null,    TaskTime             char(10)             not null,    constraint PK_TASK primary key nonclustered (TaskName)  )  go  /*==============================================================*/  /* Index: Include_FK                                            */  /*==============================================================*/  create index Include_FK on Task (  ProjectName ASC  )  go  /*==============================================================*/  /* Index: Make_FK                                               */  /*==============================================================*/  create index Make_FK on Task (  StaffNo ASC  )  go  /*==============================================================*/  /* Table: Team                                                  */  /*==============================================================*/  create table Team (    TeamName             char(20)             not null,    ProjectName          char(20)             null,    TeamLeader           char(10)             not null,    TeamNumber           int                  not null,    TeamCreateTime       datetime             not null,    constraint PK_TEAM primary key nonclustered (TeamName)  )  go  /*==============================================================*/  /* Index: Implement_FK                                          */  /*==============================================================*/  create index Implement_FK on Team (  ProjectName ASC  )  go  alter table Change    add constraint FK_CHANGE_ADMINISTE_PROJECT foreign key (ProjectName)        references Project (ProjectName)  go  alter table Difficult    add constraint FK_DIFFICUL_ADMINISTE_PROJECT foreign key (ProjectName)        references Project (ProjectName)  go  alter table &quot;Plan&quot;    add constraint FK_PLAN_ADMINISTE_PROJECT foreign key (ProjectName)        references Project (ProjectName)  go  alter table Project    add constraint FK_PROJECT_ADMINISTE_PLAN foreign key (PlanName)        references &quot;Plan&quot; (PlanName)  go  alter table Purchaes    add constraint FK_PURCHAES_PURCHAES_TASK foreign key (TaskName)        references Task (TaskName)  go  alter table Purchaes    add constraint FK_PURCHAES_PURCHAES2_ORDER foreign key (OrderName)        references &quot;Order&quot; (OrderName)  go  alter table &quot;Resource Usage&quot;    add constraint &quot;FK_RESOURCE_RESOURCE _TASK&quot; foreign key (TaskName)        references Task (TaskName)  go  alter table &quot;Resource Usage&quot;    add constraint &quot;FK_RESOURCE_RESOURCE _RESOURCE&quot; foreign key (ResourcesName)        references Resources (ResourcesName)  go  alter table Staff    add constraint FK_STAFF_MAKE2_TASK foreign key (TaskName)        references Task (TaskName)  go  alter table Staff    add constraint FK_STAFF_RELATIONS_TEAM foreign key (TeamName)        references Team (TeamName)  go  alter table Staff    add constraint &quot;FK_STAFF_TEAM LEAD_STAFF&quot; foreign key (Sta_StaffNo)        references Staff (StaffNo)  go  alter table Task    add constraint FK_TASK_INCLUDE_PROJECT foreign key (ProjectName)        references Project (ProjectName)  go  alter table Task    add constraint FK_TASK_MAKE_STAFF foreign key (StaffNo)        references Staff (StaffNo)  go  alter table Team    add constraint FK_TEAM_IMPLEMENT_PROJECT foreign key (ProjectName)        references Project (ProjectName)  go</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
